<ion-header>
  <ion-toolbar>
    <ion-title color="primary">Incluir Alquiler</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-card>
    <ion-card-content>
      <ion-label color="primary" position="stacked">Cliente</ion-label>
      <ion-item lines="none">
        <ion-input [(ngModel)]="clientName" (ionInput)="searchClient($event)"
            placeholder="Nombre completo" [debounce]="350">
        </ion-input>
        <ion-buttons>
          <ion-button (click)="viewClient()" *ngIf="selectedClient && !searchingClient">
            <ion-icon name="eye"></ion-icon>
          </ion-button>
          <ion-button (click)="addClient()" *ngIf="clientNotFound && !searchingClient">
              <ion-icon name="person-add"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-item>
      <ion-list *ngIf="clients.length > 0" class="search-result" inset="true">
          <ion-item button *ngFor="let client of clients" (click)="selectClient(client)">
            <ion-label>{{ client.name }}</ion-label>
          </ion-item>
      </ion-list>
      <ion-label *ngIf="clientNotFound && !searchingClient" color="danger">
        <ion-icon name="information"></ion-icon>
        Cliente no encontrado
      </ion-label>
      <div *ngIf="!selectedCar">
      <ion-label color="primary" position="stacked">Coches Disponibles</ion-label>
        <ion-list>
          <ion-item button (click)="openAvailableCars('A')" [disabled]="!selectedClient || searchingClient"> 
            <ion-badge slot="end">{{ availableCategoryA.length }}</ion-badge>
            <ion-label>Categoria A</ion-label>
          </ion-item>
          <ion-item button (click)="openAvailableCars('B')" [disabled]="!selectedClient || searchingClient"> 
            <ion-badge slot="end">{{ availableCategoryB.length }}</ion-badge>
            <ion-label>Categoria B</ion-label>
          </ion-item>
          <ion-item button (click)="openAvailableCars('C')" [disabled]="!selectedClient || searchingClient">
            <ion-badge slot="end">{{ availableCategoryC.length }}</ion-badge>
            <ion-label>Categoria C</ion-label>
          </ion-item>
      </ion-list> 
      </div>
      <div *ngIf="selectedCar && selectedClient">
        <ion-label color="primary" slot="start">Coche Selecionado
        <ion-buttons slot="end">
          <ion-button (click)="onClick()" fill="clear">
            <ion-icon slot="icon-only" name="create"></ion-icon>
          </ion-button>
          <ion-button (click)="onClick()" fill="clear">
              <ion-icon slot="icon-only" name="remove-circle"></ion-icon>
            </ion-button>
        </ion-buttons>
        </ion-label>
        <ion-item>
          <ion-thumbnail slot="end">
            <img [src]="selectedCar.image" />
          </ion-thumbnail>
          <ion-label>
            <ion-text color="medium">
              <h2>{{ selectedCar.registration }}</h2>
            </ion-text>
            <ion-text color="medium">
              <h3>{{ selectedCar.modelName }}</h3>
            </ion-text>
            <ion-text color="medium">
                <h3>Cantidad Combustible</h3> 
                <span>
                  <ion-range min="0" max="100" pin="true" snaps="true" step="25" 
                  ticks="true" 
                  [value]="selectedCar.fuelIndicator" color="primary">
                <ion-icon name="remove" slot="start"></ion-icon>
                <ion-icon name="add" slot="end"></ion-icon>
                </ion-range></span>
            </ion-text>
          </ion-label>
        </ion-item>
      </div>
    </ion-card-content>
  </ion-card>
  <ion-button type="submit" (click)="onSubmit()" [disabled]="!selectedCar || !selectedClient" expand="block">
      Confirmar
    </ion-button>
    <ion-button (click)="dismiss()" color="danger" expand="block">
      Cancelar
    </ion-button>
</ion-content>

